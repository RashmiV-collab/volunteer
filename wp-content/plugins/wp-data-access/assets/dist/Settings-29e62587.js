import{l as y,V as un,W as dn,a4 as ot,as as Vn,r as R,aw as bn,j as e,ax as He,au as Ge,ay as vn,az as Le,aA as he,aB as at,at as ce,aC as lt,aD as ct,aE as ut,aF as dt,aG as pt,aH as ft,aI as mt,aJ as ht,aK as gt,aL as xt,aM as bt,aN as vt,aO as jt,aP as yt,aQ as Ct,aR as Et,aS as At,aT as wt,ai as Tt,ao as jn,aq as Pt,aU as St,aj as Ce}from"./main.js";import{c as pn,d as an,k as K,B as E,n as Z,q as Ot,r as yn,w as kt,e as Lt,x as Dt,y as Mt,z as Rt,D as It,E as Ft,H as Nt,I as Vt,J as Bt,K as Ut,A as Cn,h as En,m as _t}from"./MetaData-bdfb949d.js";import{b as zt,c as Ht}from"./Actions-b625cbe1.js";import{l as Gt}from"./LanguagesSupport-f1bbac94.js";import{C as qe,u as qt,a as en,D as Wt,c as $t,S as Zt,b as Kt,d as Qt,I as nn,e as Xt,T as Jt,M as Yt,P as ei,f as Ee,g as ni}from"./SettingsTabEnum-1831dc05.js";import{A as Q,a as X,b as J,T as ue,R as ti,B as ii,c as si,S as An}from"./settings-04aa9e8b.js";import{F as S}from"./FormControl-5d7bce62.js";import{R as De}from"./RadioGroup-04724101.js";import{F as b}from"./FormControlLabel-b874e6c1.js";import{R as V}from"./Radio-4f834152.js";import{F as O}from"./FormHelperText-d043b602.js";import{A as wn,S as A,a as Tn}from"./Switch-9746da4d.js";import{T as Te}from"./TextField-0f586f77.js";import{C as ri}from"./ComputedFieldTypeEnum-9a013b11.js";import{E as tn}from"./EnumTypeEnum-7ffcf33a.js";import{e as oi,f as ai,g as li}from"./index.esm-ebe5ee0d.js";import{C as ci}from"./ConfirmDialog-c5a9ed7e.js";import{b as ui,F as Ve}from"./Select-2486f905.js";import{I as di}from"./InputAdornment-cdfef043.js";import{I as de,T as pi}from"./iconBase-8840166b.js";import{B as Ae}from"./Button-e7d59fde.js";import{A as Pn}from"./AdminTheme-ba57f315.js";import{C as Sn,a as fi}from"./CardContent-eb18906e.js";import"./dayjs.min-b4f908d3.js";import"./isEqual-956f3fe4.js";import"./createSvgIcon-d0cfe483.js";import"./Close-9e29875c.js";import"./Chip-505aa5a1.js";import"./DialogContent-0fdbfaca.js";import"./DialogTitle-3605c73e.js";const mi=({appId:n,setIsUpdated:a})=>{var k,M,q,U,Y,se,i,pe,c,ge,Pe,Se,xe,be,F,W,ne,te,re,oe,L,ae,f,r,D,B,_,z,le,ve;y.debug(n);const u=pn(),l=un(dn.getState(),n);y.debug("metaData",l);const t=an(s=>ot(s,n));y.debug("storeTableSettings",t);const x=an(s=>Vn(s,n));y.debug("columnsStore",x);const h=x.filter(s=>s.computedField!==void 0);y.debug("storeColumnSettings",h);const C=(s,d,P)=>{const[fe,...me]=d.split(".");return{...s,[fe]:me.length?C(s[fe],me.join("."),P):P}},m=(s,d)=>{y.debug(s,d);const P=C(t,s,d);y.debug(P),u(at({appId:n,tableSettings:P})),a(!0)},[w,T]=R.useState([]),[H,G]=R.useState([]);R.useEffect(()=>{var P,fe,me,Re,Ie,Fe,Ne;let s=[];(fe=(P=t==null?void 0:t.advancedSearch)==null?void 0:P.searchPanes)!=null&&fe.columns&&Array.isArray((Re=(me=t==null?void 0:t.advancedSearch)==null?void 0:me.searchPanes)==null?void 0:Re.columns)&&(s=(Fe=(Ie=t==null?void 0:t.advancedSearch)==null?void 0:Ie.searchPanes)==null?void 0:Fe.columns);const d=[...s];for(let je=0;je<((Ne=l==null?void 0:l.columns)==null?void 0:Ne.length);je++)d.includes(l==null?void 0:l.columns[je].column_name)||d.push(l==null?void 0:l.columns[je].column_name);T(d),G(s)},[l==null?void 0:l.columns]),R.useEffect(()=>{y.debug(w,H);const s=[];for(let d=0;d<w.length;d++)H.includes(w[d])&&s.push(w[d]);u(bn({appId:n,columns:s}))},[u,w,H,n]);const I=Gt;return e.jsxs(e.Fragment,{children:[e.jsxs(Q,{sx:{display:"none"},TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsx(X,{expandIcon:e.jsx(K,{}),children:"Processing"}),e.jsxs(J,{children:[e.jsx(S,{children:e.jsxs(De,{sx:{flexDirection:"row"},children:[e.jsx(b,{control:e.jsx(V,{checked:(t==null?void 0:t.processing)===He.SERVERSIDE,onChange:s=>{m("processing",He.SERVERSIDE),s.stopPropagation()}}),value:"serverside",label:"Server-side"},"serverside"),e.jsx(b,{control:e.jsx(V,{checked:(t==null?void 0:t.processing)===He.CLIENTSIDE,onChange:s=>{m("processing",He.CLIENTSIDE),s.stopPropagation()}}),value:"clientside",label:"Client-side"},"clientside")]})}),e.jsx(O,{children:"Use server-side for large tables and views, use client-side for quick analyses of small tables and views"})]})]}),e.jsxs(Q,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,defaultExpanded:!0,children:[e.jsx(X,{expandIcon:e.jsx(K,{}),children:"Responsiveness"}),e.jsxs(J,{children:[e.jsx(S,{children:e.jsxs(De,{sx:{flexDirection:"row"},children:[e.jsx(b,{control:e.jsx(V,{checked:((k=t==null?void 0:t.design)==null?void 0:k.overflow)===Ge.RESPONSIVE,onChange:s=>{m("design.overflow",Ge.RESPONSIVE),s.stopPropagation()}}),value:"responsive",label:"Auto column hiding"},"responsive"),e.jsx(b,{control:e.jsx(V,{checked:((M=t==null?void 0:t.design)==null?void 0:M.overflow)!==Ge.RESPONSIVE,onChange:s=>{m("design.overflow",Ge.SCROLL),s.stopPropagation()}}),value:"scroll",label:"Horizontal scrollbar"},"scroll")]})}),e.jsx(O,{children:"Behaviour when table content overflows available space"})]})]}),e.jsxs(Q,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsx(X,{expandIcon:e.jsx(K,{}),children:"Language"}),e.jsx(J,{children:e.jsx(S,{fullWidth:!0,children:e.jsx(wn,{multiple:!1,fullWidth:!0,disablePortal:!0,options:I,getOptionLabel:s=>s.language,value:t!=null&&t.locale?I.filter(s=>s.code===(t==null?void 0:t.locale))[0]:null,onChange:(s,d)=>{m("locale",(d==null?void 0:d.code)??"")},renderInput:s=>e.jsx(Te,{...s})})})})]}),e.jsxs(Q,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsx(X,{expandIcon:e.jsx(K,{}),children:"Row actions"}),e.jsx(J,{children:e.jsxs(E,{sx:{display:"grid"},children:[e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{disabled:!((q=l==null?void 0:l.privs)!=null&&q.insert),checked:(U=t==null?void 0:t.transactions)==null?void 0:U.insert,onChange:(s,d)=>{m("transactions.insert",d),s.stopPropagation()}}),label:"Allow insert"})}),e.jsx(O,{children:"Adds an insert button to the table toolbar"}),e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:t==null?void 0:t.viewLink,onChange:(s,d)=>{m("viewLink",d),s.stopPropagation()}}),label:"Allow viewing"})}),e.jsx(O,{children:"Adds a view icon to each row"}),e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:(Y=t==null?void 0:t.transactions)==null?void 0:Y.update,disabled:!((se=l==null?void 0:l.privs)!=null&&se.update),onChange:(s,d)=>{m("transactions.update",d),s.stopPropagation()}}),label:"Allow update"})}),e.jsx(O,{children:"Adds an update icon to each table row"}),e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:(i=t==null?void 0:t.transactions)==null?void 0:i.delete,disabled:!((pe=l==null?void 0:l.privs)!=null&&pe.delete),onChange:(s,d)=>{m("transactions.delete",d),s.stopPropagation()}}),label:"Allow delete"})}),e.jsx(O,{children:"Adds a delete icon to each table row"})]})})]}),e.jsxs(Q,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsx(X,{expandIcon:e.jsx(K,{}),children:"Bulk actions"}),e.jsxs(J,{children:[e.jsxs(E,{sx:{display:"grid"},children:[e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:!Z(l)&&((c=t==null?void 0:t.bulkActions)==null?void 0:c.pdf),disabled:!0,onChange:(s,d)=>{s.stopPropagation()}}),label:"Export to PDF"})}),e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:!Z(l)&&((ge=t==null?void 0:t.bulkActions)==null?void 0:ge.csv),disabled:Z(l),onChange:(s,d)=>{m("bulkActions.csv",d),s.stopPropagation()}}),label:"Export to CSV"})}),e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:!Z(l)&&((Pe=t==null?void 0:t.bulkActions)==null?void 0:Pe.json),disabled:Z(l),onChange:(s,d)=>{m("bulkActions.json",d),s.stopPropagation()}}),label:"Export to JSON"})}),e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:!Z(l)&&((Se=t==null?void 0:t.bulkActions)==null?void 0:Se.excel),disabled:!0,onChange:(s,d)=>{s.stopPropagation()}}),label:"Export to Excel"})}),e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:!Z(l)&&((xe=t==null?void 0:t.bulkActions)==null?void 0:xe.xml),disabled:Z(l),onChange:(s,d)=>{m("bulkActions.xml",d),s.stopPropagation()}}),label:"Export to XML"})}),e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:!Z(l)&&((be=t==null?void 0:t.bulkActions)==null?void 0:be.sql),disabled:Z(l),onChange:(s,d)=>{m("bulkActions.sql",d),s.stopPropagation()}}),label:"Export to SQL"})}),e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:!Z(l)&&((F=t==null?void 0:t.bulkActions)==null?void 0:F.delete),disabled:Z(l),onChange:(s,d)=>{m("bulkActions.delete",d),s.stopPropagation()}}),label:"Delete"})})]}),e.jsx(O,{sx:{marginTop:"10px"},children:"Added to menu button"})]})]}),e.jsxs(Q,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,defaultExpanded:!1,children:[e.jsx(X,{expandIcon:e.jsx(K,{}),children:"Search settings"}),e.jsx(J,{children:e.jsxs(E,{children:[e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:(W=t==null?void 0:t.searchSettings)==null?void 0:W.forceEnterOnSearch,disabled:!0,onChange:(s,d)=>{m("searchSettings.forceEnterOnSearch",d),s.stopPropagation()}}),label:"User must press enter key to start search"})}),e.jsx(O,{sx:{marginTop:"10px",marginBottom:"20px"},children:"Prevents sending a request on every key pressed (reduces network traffic and server load)"}),e.jsx(S,{children:e.jsx(b,{control:e.jsx(A,{checked:!((ne=t==null?void 0:t.searchSettings)!=null&&ne.forceEnterOnSearch)&&((te=t==null?void 0:t.searchSettings)==null?void 0:te.highlightMatches),disabled:!0,onChange:(s,d)=>{m("searchSettings.highlightMatches",d),s.stopPropagation()}}),label:"Highlight matches"})}),e.jsx(O,{sx:{marginTop:"10px"},children:"Not available when pressing enter key is required"})]})})]}),e.jsxs(Q,{sx:{display:"none"},TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsx(X,{expandIcon:e.jsx(K,{}),children:"Advanced Search"}),e.jsx(J,{children:e.jsxs(E,{sx:{marginTop:"20px",display:"grid",gap:"20px"},children:[e.jsxs(E,{children:[e.jsx(b,{control:e.jsx(A,{checked:(oe=(re=t==null?void 0:t.advancedSearch)==null?void 0:re.searchPanes)==null?void 0:oe.enabled,disabled:!0,onChange:(s,d)=>{s.stopPropagation()}}),label:"Enable search panes"}),e.jsx(O,{children:"Quickly filter table data based on columns values"})]}),e.jsx(wn,{multiple:!0,disablePortal:!0,disabled:((ae=(L=t==null?void 0:t.advancedSearch)==null?void 0:L.searchPanes)==null?void 0:ae.enabled)!==!0,options:w,getOptionLabel:s=>s,value:(r=(f=t==null?void 0:t.advancedSearch)==null?void 0:f.searchPanes)==null?void 0:r.columns,fullWidth:!0,onChange:(s,d)=>{u(bn({appId:n,columns:d}))},renderInput:s=>e.jsx(Te,{...s,label:"Add columns to search panes..."})}),e.jsxs(E,{sx:{display:"grid",gridTemplateColumns:" auto auto",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(De,{sx:{flexDirection:"row"},children:[e.jsx(b,{control:e.jsx(V,{disabled:!0,checked:((B=(D=t==null?void 0:t.advancedSearch)==null?void 0:D.searchPanes)==null?void 0:B.orientation)===vn.HORIZONTAL,onChange:s=>{s.stopPropagation()}}),value:"horizontal",label:"Horizontal"},"horizontal"),e.jsx(b,{control:e.jsx(V,{disabled:!0,checked:((z=(_=t==null?void 0:t.advancedSearch)==null?void 0:_.searchPanes)==null?void 0:z.orientation)===vn.VERTICAL,onChange:s=>{s.stopPropagation()}}),value:"vertical ",label:"Vertical"},"vertical")]}),e.jsx(b,{sx:{marginRight:0},control:e.jsx(A,{disabled:!0,checked:(ve=(le=t==null?void 0:t.advancedSearch)==null?void 0:le.searchPanes)==null?void 0:ve.cascade,onChange:(s,d)=>{m("advancedSearch.searchPanes.cascade",d),s.stopPropagation()}}),label:"Cascade"})]})]})})]}),e.jsxs(Q,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,defaultExpanded:!1,children:[e.jsx(X,{expandIcon:e.jsx(K,{}),children:"Spacing"}),e.jsxs(J,{children:[e.jsx(S,{children:e.jsxs(De,{sx:{display:"grid",gridTemplateColumns:"auto auto auto",alignItems:"center"},children:[e.jsx(b,{control:e.jsx(V,{checked:(t==null?void 0:t.design.density.default)===Le.COMPACT,onChange:s=>{m("design.density.default",Le.COMPACT),s.stopPropagation()}}),value:"compact",label:"Compact"},"compact"),e.jsx(b,{control:e.jsx(V,{checked:(t==null?void 0:t.design.density.default)===Le.COMFORTABLE,onChange:s=>{m("design.density.default",Le.COMFORTABLE),s.stopPropagation()}}),value:"comfortable",label:"Comfortable"},"comfortable"),e.jsx(b,{control:e.jsx(V,{checked:(t==null?void 0:t.design.density.default)===Le.SPACIOUS,onChange:s=>{m("design.density.default",Le.SPACIOUS),s.stopPropagation()}}),value:"spacious",label:"Spacious"},"spacious")]})}),e.jsx(O,{children:"Default spacing on page load"}),e.jsx(S,{sx:{marginTop:"20px"},children:e.jsx(b,{control:e.jsx(A,{checked:t==null?void 0:t.design.density.userCanChange,onChange:(s,d)=>{m("design.density.userCanChange",d),s.stopPropagation()}}),label:"Allow user to change spacing"})})]})]}),e.jsxs(Q,{defaultExpanded:!1,TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsx(X,{expandIcon:e.jsx(K,{}),children:"Inline fields"}),e.jsxs(J,{sx:{display:"grid"},children:[e.jsxs(De,{value:t.inlineEditing.fieldVariant,sx:{flexDirection:"row"},onChange:s=>{s.stopPropagation()},children:[e.jsx(b,{control:e.jsx(V,{disabled:!0}),value:"outlined",label:"Outlined"},"outlined"),e.jsx(b,{control:e.jsx(V,{disabled:!0}),value:"filled",label:"Filled"},"filled"),e.jsx(b,{control:e.jsx(V,{disabled:!0}),value:"standard",label:"Standard"},"standard")]}),e.jsx(O,{children:"Applies to inline fields only"}),e.jsxs(E,{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginTop:"40px",marginBottom:"10px"},children:[e.jsx(qe,{label:"Padding top",textField:{cssValue:t.inlineEditing.spacing.fieldTop,cssUnit:t.inlineEditing.spacing.fieldTopUnit},defaultValue:{cssValue:he.table.inlineEditing.spacing.fieldTop,cssUnit:he.table.inlineEditing.spacing.fieldTopUnit},updateSettings:s=>{const d={...t.inlineEditing.spacing,fieldTop:s.cssValue,fieldTopUnit:s.cssUnit};m("inlineEditing.spacing",d)}}),e.jsx(qe,{label:"Padding bottom",textField:{cssValue:t.inlineEditing.spacing.fieldBottom,cssUnit:t.inlineEditing.spacing.fieldBottomUnit},defaultValue:{cssValue:he.table.inlineEditing.spacing.fieldBottom,cssUnit:he.table.inlineEditing.spacing.fieldBottomUnit},updateSettings:s=>{const d={...t.inlineEditing.spacing,fieldBottom:s.cssValue,fieldBottomUnit:s.cssUnit};m("inlineEditing.spacing",d)}}),e.jsx(qe,{label:"Padding left",textField:{cssValue:t.inlineEditing.spacing.fieldLeft,cssUnit:t.inlineEditing.spacing.fieldLeftUnit},defaultValue:{cssValue:he.table.inlineEditing.spacing.fieldLeft,cssUnit:he.table.inlineEditing.spacing.fieldLeftUnit},updateSettings:s=>{const d={...t.inlineEditing.spacing,fieldLeft:s.cssValue,fieldLeftUnit:s.cssUnit};m("inlineEditing.spacing",d)}}),e.jsx(qe,{label:"Padding right",textField:{cssValue:t.inlineEditing.spacing.fieldRight,cssUnit:t.inlineEditing.spacing.fieldRightUnit},defaultValue:{cssValue:he.table.inlineEditing.spacing.fieldRight,cssUnit:he.table.inlineEditing.spacing.fieldRightUnit},updateSettings:s=>{const d={...t.inlineEditing.spacing,fieldRight:s.cssValue,fieldRightUnit:s.cssUnit};m("inlineEditing.spacing",d)}})]}),e.jsx(O,{children:"Space added to inline fields"})]})]})]})},hi=({appId:n,setIsUpdated:a,setComputeFieldOpen:u,setHasErrors:l})=>{y.debug(n);const t=pn(),x=qt(en(ei),en(Yt),en(Jt)),h=un(dn.getState(),n);y.debug("metaData",h);const C={label:"",type:ri.TEXT,expression:""},[m,w]=R.useState(-1),[T,H]=R.useState(C),[G,I]=R.useState(!1),[k,M]=R.useState(!1),[q,U]=R.useState(!1),[Y,se]=R.useState(void 0);R.useEffect(()=>{u(G)},[G,u]);const i=R.useMemo(()=>{const f=[];for(let r=0;r<h.columns.length;r++)f.push(h.columns[r].column_name);return f.sort((r,D)=>r>D?1:-1),f},[n]);y.debug(i);const pe=an(f=>Vn(f,n));y.debug("columnsStore",pe);const c=pe.filter(f=>f.computedField!==void 0);y.debug("columns",c);const ge=(f,r)=>{y.debug(f,r),t(gt({appId:n,index:f,visible:r})),a(!0)},Pe=(f,r)=>{y.debug(f,r),t(xt({appId:n,index:f,visible:r})),a(!0)},Se=(f,r)=>{y.debug(f,r),t(bt({appId:n,index:f,visible:r})),a(!0)},xe=(f,r)=>{y.debug(f,r),t(vt({appId:n,index:f,queryable:r})),a(!0)},be=(f,r)=>{y.debug(f,r),t(jt({appId:n,index:f,orderable:r})),a(!0)},F=(f,r)=>{y.debug(f,r)},W=(f,r)=>{y.debug(f,r),t(yt({appId:n,index:f,inlineEditing:r})),a(!0)},ne=(f,r)=>{y.debug(f,r),t(Ct({appId:n,index:f,inlineNumericMin:r})),a(!0)},te=(f,r)=>{y.debug(f,r),t(Et({appId:n,index:f,inlineNumericMax:r})),a(!0)},re=(f,r)=>{t(At({appId:n,index:f,alignment:r})),a(!0)},oe=f=>{const{active:r,over:D}=f;y.debug(r,D),(r==null?void 0:r.id)!==(D==null?void 0:D.id)&&t(wt({appId:n,source:r.id,destination:D.id}))},L=f=>{},ae=c.map(f=>f.columnName);return y.debug("sortableColumns",ae),e.jsxs(e.Fragment,{children:[e.jsxs(Wt,{autoScroll:!0,sensors:x,collisionDetection:$t,onDragEnd:oe,children:[e.jsxs(Zt,{items:ae,children:[ae.map((f,r)=>{var le,ve;const D=c[r].computedField?((le=c[r].computedField)==null?void 0:le.label)===""?"<No Label>":((ve=c[r].computedField)==null?void 0:ve.label)??f:c[r].columnLabel??f,B=Ot(h,f),_=B!==void 0?h.columns[B]:null,z=B!==void 0?yn(h.columns[B].data_type,!0):"";return e.jsx(Kt,{id:f,children:e.jsxs(Q,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsxs(X,{className:"pp-column-settings",expandIcon:e.jsx(K,{}),sx:{justifyContent:"space-between"},children:[e.jsxs(E,{sx:{display:"grid",gridTemplateColumns:"auto 1fr","& svg":{display:"flex"}},children:[e.jsx(Qt,{id:f,enabled:!0}),e.jsx(ui,{value:D,sx:{marginRight:"1rem","&::before":{border:"none"},"& input":{padding:0}},disabled:!0,onClick:s=>{s.stopPropagation()},onChange:s=>{},startAdornment:c[r].computedField!==void 0&&e.jsx(di,{position:"start",children:e.jsx(oi,{})})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 40px 40px 40px"},children:[e.jsx(ue,{title:"Visible",position:"bottom",children:e.jsx(de,{onClick:s=>{ge(r,!c[r].visible),s.stopPropagation()},children:e.jsx(nn,{checked:c[r].visible,children:e.jsx(kt,{})})})}),c[r].computedField?e.jsx(ue,{title:"Edit",position:"bottom",children:e.jsx(de,{onClick:s=>{s.stopPropagation()},children:e.jsx(Dt,{})})}):e.jsx(ue,{title:"Searchable",position:"bottom",children:e.jsx(de,{onClick:s=>{xe(r,!c[r].queryable),s.stopPropagation()},children:e.jsx(nn,{checked:c[r].queryable,alignRight:!1,children:e.jsx(Lt,{})})})}),c[r].computedField?e.jsx(ue,{title:"Delete",position:"bottom",children:e.jsx(de,{onClick:s=>{se(r),U(!0),s.stopPropagation()},children:e.jsx(Rt,{})})}):e.jsx(ue,{title:"Sortable",position:"bottom",children:e.jsx(de,{onClick:s=>{be(r,!c[r].orderable),s.stopPropagation()},children:e.jsx(nn,{checked:c[r].orderable,children:e.jsx(Mt,{})})})}),e.jsx(ue,{title:"Alignment",position:"bottom",children:e.jsxs(de,{onClick:s=>{c[r].alignment===ce.LEFT?re(r,ce.CENTER):c[r].alignment===ce.CENTER?re(r,ce.RIGHT):c[r].alignment===ce.RIGHT&&re(r,ce.LEFT),s.stopPropagation()},children:[c[r].alignment===ce.LEFT&&e.jsx(It,{}),c[r].alignment===ce.CENTER&&e.jsx(Ft,{}),c[r].alignment===ce.RIGHT&&e.jsx(Nt,{})]})})]})]}),e.jsxs(J,{children:[e.jsxs(E,{sx:{margin:"0 10px",display:"grid",gridTemplateColumns:"auto auto",gridGap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(b,{control:e.jsx(A,{checked:c[r].visible&&c[r].visibleTablet,disabled:!0,onClick:s=>{Pe(r,!c[r].visibleTablet),s.stopPropagation()}}),label:"Visible on tablet",labelPlacement:"end"}),c[r].computedField?e.jsx(b,{control:e.jsx(A,{checked:!1,disabled:!0}),label:"Inline search",labelPlacement:"end"}):e.jsx(b,{control:e.jsx(A,{checked:c[r].queryable&&c[r].inlineSearch,disabled:!0,onChange:(s,d)=>{F(r,d),s.stopPropagation()}}),label:"Inline search",labelPlacement:"end"}),e.jsx(b,{control:e.jsx(A,{checked:c[r].visible&&c[r].visibleMobile,disabled:!0,onClick:s=>{Se(r,!c[r].visibleMobile),s.stopPropagation()}}),label:"Visible on mobile",labelPlacement:"end"}),c[r].computedField?e.jsx(b,{control:e.jsx(A,{checked:!1,disabled:!0}),label:"Inline editing",labelPlacement:"end"}):e.jsx(b,{control:e.jsx(A,{checked:c[r].visible&&c[r].inlineEditing,disabled:!0,onChange:(s,d)=>{W(r,d),s.stopPropagation()}}),label:"Inline editing",labelPlacement:"end"})]}),e.jsxs(E,{sx:{paddingBottom:"0"},children:[c[r].inlineEditing===!0&&B!==void 0&&h.columns[B].data_type==="enum"&&e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"30px"},children:[e.jsx("legend",{children:"Show values in"}),e.jsxs(De,{sx:{flexDirection:"column",alignContent:"flex-start",marginTop:"30px"},children:[e.jsxs(Ve,{className:"align-label-radio",children:[e.jsx(V,{checked:c[r].inlineEditingEnum===void 0||c[r].inlineEditingEnum===tn.LIST,disabled:!0,onChange:s=>{s.stopPropagation()}}),"Drop-down List"]}),e.jsxs(Ve,{className:"align-label-radio",children:[e.jsx(V,{checked:c[r].inlineEditingEnum===tn.RADIO_HORIZONTAL,disabled:!0,onChange:s=>{s.stopPropagation()}}),"Radio group horizontal"]}),e.jsxs(Ve,{className:"align-label-radio",children:[e.jsx(V,{checked:c[r].inlineEditingEnum===tn.RADIO_VERTICAL,disabled:!0,onChange:s=>{s.stopPropagation()}}),"Radio group vertical"]})]})]}),c[r].inlineEditing===!0&&B!==void 0&&yn(h.columns[B].data_type)==="number"&&e.jsxs(S,{sx:{marginTop:"20px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx(Te,{error:k,type:"number",label:"Minimum value allowed",disabled:!0,value:c[r].inlineNumericMin??"",required:!1,InputLabelProps:{shrink:!0},onChange:s=>{if(c[r].inlineNumericMax!==void 0&&s.target.value!==""){const d=parseInt(s.target.value),P=c[r].inlineNumericMax??0;d<=P?(M(!1),l(!1)):(M(!0),l(!0))}else M(!1),l(!1);ne(r,s.target.value)}}),e.jsx(Te,{error:k,type:"number",label:"Maximum value allowed",disabled:!0,value:c[r].inlineNumericMax??"",required:!1,InputLabelProps:{shrink:!0},onChange:s=>{if(c[r].inlineNumericMin!==void 0&&s.target.value!==""){const d=c[r].inlineNumericMin??0,P=parseInt(s.target.value);d<=P?(M(!1),l(!1)):(M(!0),l(!0))}else M(!1),l(!1);te(r,s.target.value)}})]})]}),e.jsxs(E,{sx:{margin:"2rem 1rem"},children:[e.jsx(Ve,{children:"Width"}),e.jsxs(E,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gridGap:"30px",alignItems:"center"},children:[e.jsx(Tn,{min:60,max:420,step:1,value:c[r].width,marks:[{value:60,label:"60"},{value:120,label:"120"},{value:180,label:"180"},{value:240,label:"240"},{value:300,label:"320"},{value:360,label:"360"},{value:420,label:"420"}],valueLabelDisplay:"auto",onChange:(s,d)=>{t(lt({appId:n,index:r,width:d})),s.stopPropagation()}}),e.jsx("span",{children:"px"})]})]}),e.jsxs(E,{children:[e.jsxs(Q,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsxs(X,{expandIcon:e.jsx(K,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(ai,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column settings"})]}),e.jsxs(J,{sx:{display:"grid",gridGap:"2rem",paddingTop:"1rem"},children:[(z==="float"||z==="number"||c[r].computedField)&&e.jsxs(E,{children:[e.jsx(E,{sx:{display:"block"},children:e.jsx(b,{control:e.jsx(A,{checked:c[r].localize,disabled:!0,onClick:s=>{t(ct({appId:n,index:r,localize:!c[r].localize})),s.stopPropagation()}}),label:"Localize numeric value",labelPlacement:"end"})}),e.jsx(O,{children:"Localizes decimal and thousands seperators (does not affect inline fields)"})]}),(z==="float"||c[r].computedField)&&e.jsxs(E,{sx:{display:"grid"},children:[e.jsx(Ve,{children:"Decimals"}),e.jsx(Tn,{min:0,max:6,value:c[r].decimals,marks:[{value:0,label:"0"},{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"∞"}],valueLabelDisplay:"off",disabled:!0,onChange:(s,d)=>{t(ut({appId:n,index:r,decimals:d})),s.stopPropagation()}}),e.jsx(O,{children:"Number of decimals displayed (does not affect inline fields)"})]}),(z==="date"||z==="datetime")&&e.jsxs(E,{children:[e.jsx(E,{sx:{display:"block"},children:e.jsx(b,{control:e.jsx(A,{checked:c[r].dateZeros,disabled:!0,onClick:s=>{t(dt({appId:n,index:r,dateZeros:!c[r].dateZeros})),s.stopPropagation()}}),label:"Add trailing zeros to days and month",labelPlacement:"end"})}),e.jsx(O,{children:"Localizes decimal and thousands seperators"})]}),(z==="time"||z==="datetime")&&e.jsxs(E,{children:[e.jsx(E,{sx:{display:"block"},children:e.jsx(b,{control:e.jsx(A,{checked:c[r].timeZeros,disabled:!0,onClick:s=>{t(pt({appId:n,index:r,timeZeros:!c[r].timeZeros})),s.stopPropagation()}}),label:"Add trailing zeros to hours, minutes and seconds",labelPlacement:"end"})}),e.jsx(O,{children:"Localizes decimal and thousands seperators"})]}),e.jsxs(E,{children:[e.jsxs(E,{sx:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(Te,{type:"text",variant:"outlined",label:"Prefix",value:c[r].prefix,disabled:!0,InputLabelProps:{shrink:!0},onChange:s=>{t(ft({appId:n,index:r,prefix:s.target.value})),s.stopPropagation()}}),e.jsx(Te,{type:"text",variant:"outlined",label:"Suffix",value:c[r].suffix,disabled:!0,InputLabelProps:{shrink:!0},onChange:s=>{t(mt({appId:n,index:r,suffix:s.target.value})),s.stopPropagation()}})]}),e.jsx(O,{children:"Adds a prefix and/or suffix to the column content (also added to inline text and number fields)"})]}),e.jsxs(E,{children:[e.jsx(Te,{type:"text",variant:"outlined",label:"CSS classes",fullWidth:!0,value:c[r].classNames,disabled:!0,InputLabelProps:{shrink:!0},onChange:s=>{t(ht({appId:n,index:r,classNames:s.target.value})),s.stopPropagation()}}),e.jsx(O,{children:"CSS classes (seperated by spaces) for custom styling"})]})]})]}),_!==null&&e.jsxs(Q,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsxs(X,{expandIcon:e.jsx(K,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(li,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column meta data"})]}),e.jsx(J,{sx:{display:"grid"},children:e.jsxs(E,{sx:{marginTop:"1rem",display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"left",alignItems:"center"},children:[e.jsx("div",{children:"Column name"}),e.jsx("div",{children:e.jsx("strong",{children:_.column_name})}),e.jsx("div",{children:"Data type"}),e.jsx("div",{children:e.jsx("strong",{children:_.column_type})}),e.jsx("div",{children:"Is nullable"}),e.jsx("div",{children:e.jsx("strong",{children:_.is_nullable})}),e.jsx("div",{children:"Default value"}),e.jsx("div",{children:e.jsx("strong",{children:_.column_default??"null"})}),_.extra!==""&&e.jsxs(e.Fragment,{children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("strong",{children:_.extra})})]})]})})]})]})]})]},r)},f+r)}),e.jsx(Xt,{})]}),e.jsx(E,{sx:{padding:"15px 15px 25px 5px",marginBottom:"5px",textAlign:"right"},children:e.jsx(Ae,{variant:"contained",startIcon:e.jsx(Vt,{}),disabled:!0,onClick:()=>{w(-1),H(C),I(!0)},children:"Computed Field"})}),!1]}),e.jsx(ci,{title:"Delete computed field?",message:"Are you sure you want to delete this computed field? This action cannot be undone!",open:q,setOpen:U,onConfirm:()=>L()})]})};var gi="tippy-box",Bn="tippy-content",xi="tippy-backdrop",Un="tippy-arrow",_n="tippy-svg-arrow",we={passive:!0,capture:!0},zn=function(){return document.body};function sn(n,a,u){if(Array.isArray(n)){var l=n[a];return l??(Array.isArray(u)?u[a]:u)}return n}function fn(n,a){var u={}.toString.call(n);return u.indexOf("[object")===0&&u.indexOf(a+"]")>-1}function Hn(n,a){return typeof n=="function"?n.apply(void 0,a):n}function On(n,a){if(a===0)return n;var u;return function(l){clearTimeout(u),u=setTimeout(function(){n(l)},a)}}function bi(n){return n.split(/\s+/).filter(Boolean)}function Me(n){return[].concat(n)}function kn(n,a){n.indexOf(a)===-1&&n.push(a)}function vi(n){return n.filter(function(a,u){return n.indexOf(a)===u})}function ji(n){return n.split("-")[0]}function Ze(n){return[].slice.call(n)}function Ln(n){return Object.keys(n).reduce(function(a,u){return n[u]!==void 0&&(a[u]=n[u]),a},{})}function Be(){return document.createElement("div")}function Ke(n){return["Element","Fragment"].some(function(a){return fn(n,a)})}function yi(n){return fn(n,"NodeList")}function Ci(n){return fn(n,"MouseEvent")}function Gn(n){return!!(n&&n._tippy&&n._tippy.reference===n)}function Ei(n){return Ke(n)?[n]:yi(n)?Ze(n):Array.isArray(n)?n:Ze(document.querySelectorAll(n))}function rn(n,a){n.forEach(function(u){u&&(u.style.transitionDuration=a+"ms")})}function Dn(n,a){n.forEach(function(u){u&&u.setAttribute("data-state",a)})}function Ai(n){var a,u=Me(n),l=u[0];return l!=null&&(a=l.ownerDocument)!=null&&a.body?l.ownerDocument:document}function wi(n,a){var u=a.clientX,l=a.clientY;return n.every(function(t){var x=t.popperRect,h=t.popperState,C=t.props,m=C.interactiveBorder,w=ji(h.placement),T=h.modifiersData.offset;if(!T)return!0;var H=w==="bottom"?T.top.y:0,G=w==="top"?T.bottom.y:0,I=w==="right"?T.left.x:0,k=w==="left"?T.right.x:0,M=x.top-l+H>m,q=l-x.bottom-G>m,U=x.left-u+I>m,Y=u-x.right-k>m;return M||q||U||Y})}function on(n,a,u){var l=a+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(t){n[l](t,u)})}function Mn(n,a){for(var u=a;u;){var l;if(n.contains(u))return!0;u=u.getRootNode==null||(l=u.getRootNode())==null?void 0:l.host}return!1}var ie={isTouch:!1},Rn=0;function Ti(){ie.isTouch||(ie.isTouch=!0,window.performance&&document.addEventListener("mousemove",qn))}function qn(){var n=performance.now();n-Rn<20&&(ie.isTouch=!1,document.removeEventListener("mousemove",qn)),Rn=n}function Pi(){var n=document.activeElement;if(Gn(n)){var a=n._tippy;n.blur&&!a.state.isVisible&&n.blur()}}function Si(){document.addEventListener("touchstart",Ti,we),window.addEventListener("blur",Pi)}var Oi=typeof window<"u"&&typeof document<"u",ki=Oi?!!window.msCrypto:!1,Li={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Di={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},ee=Object.assign({appendTo:zn,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},Li,Di),Mi=Object.keys(ee),Ri=function(a){var u=Object.keys(a);u.forEach(function(l){ee[l]=a[l]})};function Wn(n){var a=n.plugins||[],u=a.reduce(function(l,t){var x=t.name,h=t.defaultValue;if(x){var C;l[x]=n[x]!==void 0?n[x]:(C=ee[x])!=null?C:h}return l},{});return Object.assign({},n,u)}function Ii(n,a){var u=a?Object.keys(Wn(Object.assign({},ee,{plugins:a}))):Mi,l=u.reduce(function(t,x){var h=(n.getAttribute("data-tippy-"+x)||"").trim();if(!h)return t;if(x==="content")t[x]=h;else try{t[x]=JSON.parse(h)}catch{t[x]=h}return t},{});return l}function In(n,a){var u=Object.assign({},a,{content:Hn(a.content,[n])},a.ignoreAttributes?{}:Ii(n,a.plugins));return u.aria=Object.assign({},ee.aria,u.aria),u.aria={expanded:u.aria.expanded==="auto"?a.interactive:u.aria.expanded,content:u.aria.content==="auto"?a.interactive?null:"describedby":u.aria.content},u}var Fi=function(){return"innerHTML"};function ln(n,a){n[Fi()]=a}function Fn(n){var a=Be();return n===!0?a.className=Un:(a.className=_n,Ke(n)?a.appendChild(n):ln(a,n)),a}function Nn(n,a){Ke(a.content)?(ln(n,""),n.appendChild(a.content)):typeof a.content!="function"&&(a.allowHTML?ln(n,a.content):n.textContent=a.content)}function cn(n){var a=n.firstElementChild,u=Ze(a.children);return{box:a,content:u.find(function(l){return l.classList.contains(Bn)}),arrow:u.find(function(l){return l.classList.contains(Un)||l.classList.contains(_n)}),backdrop:u.find(function(l){return l.classList.contains(xi)})}}function $n(n){var a=Be(),u=Be();u.className=gi,u.setAttribute("data-state","hidden"),u.setAttribute("tabindex","-1");var l=Be();l.className=Bn,l.setAttribute("data-state","hidden"),Nn(l,n.props),a.appendChild(u),u.appendChild(l),t(n.props,n.props);function t(x,h){var C=cn(a),m=C.box,w=C.content,T=C.arrow;h.theme?m.setAttribute("data-theme",h.theme):m.removeAttribute("data-theme"),typeof h.animation=="string"?m.setAttribute("data-animation",h.animation):m.removeAttribute("data-animation"),h.inertia?m.setAttribute("data-inertia",""):m.removeAttribute("data-inertia"),m.style.maxWidth=typeof h.maxWidth=="number"?h.maxWidth+"px":h.maxWidth,h.role?m.setAttribute("role",h.role):m.removeAttribute("role"),(x.content!==h.content||x.allowHTML!==h.allowHTML)&&Nn(w,n.props),h.arrow?T?x.arrow!==h.arrow&&(m.removeChild(T),m.appendChild(Fn(h.arrow))):m.appendChild(Fn(h.arrow)):T&&m.removeChild(T)}return{popper:a,onUpdate:t}}$n.$$tippy=!0;var Ni=1,We=[],$e=[];function Vi(n,a){var u=In(n,Object.assign({},ee,Wn(Ln(a)))),l,t,x,h=!1,C=!1,m=!1,w=!1,T,H,G,I=[],k=On(Ie,u.interactiveDebounce),M,q=Ni++,U=null,Y=vi(u.plugins),se={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},i={id:q,reference:n,popper:Be(),popperInstance:U,props:u,state:se,plugins:Y,clearDelayTimeouts:Xn,setProps:Jn,setContent:Yn,show:et,hide:nt,hideWithInteractivity:tt,enable:Kn,disable:Qn,unmount:it,destroy:st};if(!u.render)return i;var pe=u.render(i),c=pe.popper,ge=pe.onUpdate;c.setAttribute("data-tippy-root",""),c.id="tippy-"+i.id,i.popper=c,n._tippy=i,c._tippy=i;var Pe=Y.map(function(o){return o.fn(i)}),Se=n.hasAttribute("aria-expanded");return fe(),f(),oe(),L("onCreate",[i]),u.showOnCreate&&gn(),c.addEventListener("mouseenter",function(){i.props.interactive&&i.state.isVisible&&i.clearDelayTimeouts()}),c.addEventListener("mouseleave",function(){i.props.interactive&&i.props.trigger.indexOf("mouseenter")>=0&&ne().addEventListener("mousemove",k)}),i;function xe(){var o=i.props.touch;return Array.isArray(o)?o:[o,0]}function be(){return xe()[0]==="hold"}function F(){var o;return!!((o=i.props.render)!=null&&o.$$tippy)}function W(){return M||n}function ne(){var o=W().parentNode;return o?Ai(o):document}function te(){return cn(c)}function re(o){return i.state.isMounted&&!i.state.isVisible||ie.isTouch||T&&T.type==="focus"?0:sn(i.props.delay,o?0:1,ee.delay)}function oe(o){o===void 0&&(o=!1),c.style.pointerEvents=i.props.interactive&&!o?"":"none",c.style.zIndex=""+i.props.zIndex}function L(o,p,g){if(g===void 0&&(g=!0),Pe.forEach(function(v){v[o]&&v[o].apply(v,p)}),g){var j;(j=i.props)[o].apply(j,p)}}function ae(){var o=i.props.aria;if(o.content){var p="aria-"+o.content,g=c.id,j=Me(i.props.triggerTarget||n);j.forEach(function(v){var N=v.getAttribute(p);if(i.state.isVisible)v.setAttribute(p,N?N+" "+g:g);else{var $=N&&N.replace(g,"").trim();$?v.setAttribute(p,$):v.removeAttribute(p)}})}}function f(){if(!(Se||!i.props.aria.expanded)){var o=Me(i.props.triggerTarget||n);o.forEach(function(p){i.props.interactive?p.setAttribute("aria-expanded",i.state.isVisible&&p===W()?"true":"false"):p.removeAttribute("aria-expanded")})}}function r(){ne().removeEventListener("mousemove",k),We=We.filter(function(o){return o!==k})}function D(o){if(!(ie.isTouch&&(m||o.type==="mousedown"))){var p=o.composedPath&&o.composedPath()[0]||o.target;if(!(i.props.interactive&&Mn(c,p))){if(Me(i.props.triggerTarget||n).some(function(g){return Mn(g,p)})){if(ie.isTouch||i.state.isVisible&&i.props.trigger.indexOf("click")>=0)return}else L("onClickOutside",[i,o]);i.props.hideOnClick===!0&&(i.clearDelayTimeouts(),i.hide(),C=!0,setTimeout(function(){C=!1}),i.state.isMounted||le())}}}function B(){m=!0}function _(){m=!1}function z(){var o=ne();o.addEventListener("mousedown",D,!0),o.addEventListener("touchend",D,we),o.addEventListener("touchstart",_,we),o.addEventListener("touchmove",B,we)}function le(){var o=ne();o.removeEventListener("mousedown",D,!0),o.removeEventListener("touchend",D,we),o.removeEventListener("touchstart",_,we),o.removeEventListener("touchmove",B,we)}function ve(o,p){d(o,function(){!i.state.isVisible&&c.parentNode&&c.parentNode.contains(c)&&p()})}function s(o,p){d(o,p)}function d(o,p){var g=te().box;function j(v){v.target===g&&(on(g,"remove",j),p())}if(o===0)return p();on(g,"remove",H),on(g,"add",j),H=j}function P(o,p,g){g===void 0&&(g=!1);var j=Me(i.props.triggerTarget||n);j.forEach(function(v){v.addEventListener(o,p,g),I.push({node:v,eventType:o,handler:p,options:g})})}function fe(){be()&&(P("touchstart",Re,{passive:!0}),P("touchend",Fe,{passive:!0})),bi(i.props.trigger).forEach(function(o){if(o!=="manual")switch(P(o,Re),o){case"mouseenter":P("mouseleave",Fe);break;case"focus":P(ki?"focusout":"blur",Ne);break;case"focusin":P("focusout",Ne);break}})}function me(){I.forEach(function(o){var p=o.node,g=o.eventType,j=o.handler,v=o.options;p.removeEventListener(g,j,v)}),I=[]}function Re(o){var p,g=!1;if(!(!i.state.isEnabled||je(o)||C)){var j=((p=T)==null?void 0:p.type)==="focus";T=o,M=o.currentTarget,f(),!i.state.isVisible&&Ci(o)&&We.forEach(function(v){return v(o)}),o.type==="click"&&(i.props.trigger.indexOf("mouseenter")<0||h)&&i.props.hideOnClick!==!1&&i.state.isVisible?g=!0:gn(o),o.type==="click"&&(h=!g),g&&!j&&Ue(o)}}function Ie(o){var p=o.target,g=W().contains(p)||c.contains(p);if(!(o.type==="mousemove"&&g)){var j=Xe().concat(c).map(function(v){var N,$=v._tippy,Oe=(N=$.popperInstance)==null?void 0:N.state;return Oe?{popperRect:v.getBoundingClientRect(),popperState:Oe,props:u}:null}).filter(Boolean);wi(j,o)&&(r(),Ue(o))}}function Fe(o){var p=je(o)||i.props.trigger.indexOf("click")>=0&&h;if(!p){if(i.props.interactive){i.hideWithInteractivity(o);return}Ue(o)}}function Ne(o){i.props.trigger.indexOf("focusin")<0&&o.target!==W()||i.props.interactive&&o.relatedTarget&&c.contains(o.relatedTarget)||Ue(o)}function je(o){return ie.isTouch?be()!==o.type.indexOf("touch")>=0:!1}function mn(){hn();var o=i.props,p=o.popperOptions,g=o.placement,j=o.offset,v=o.getReferenceClientRect,N=o.moveTransition,$=F()?cn(c).arrow:null,Oe=v?{getBoundingClientRect:v,contextElement:v.contextElement||W()}:n,xn={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(_e){var ke=_e.state;if(F()){var rt=te(),Ye=rt.box;["placement","reference-hidden","escaped"].forEach(function(ze){ze==="placement"?Ye.setAttribute("data-placement",ke.placement):ke.attributes.popper["data-popper-"+ze]?Ye.setAttribute("data-"+ze,""):Ye.removeAttribute("data-"+ze)}),ke.attributes.popper={}}}},ye=[{name:"offset",options:{offset:j}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!N}},xn];F()&&$&&ye.push({name:"arrow",options:{element:$,padding:3}}),ye.push.apply(ye,(p==null?void 0:p.modifiers)||[]),i.popperInstance=Ut(Oe,c,Object.assign({},p,{placement:g,onFirstUpdate:G,modifiers:ye}))}function hn(){i.popperInstance&&(i.popperInstance.destroy(),i.popperInstance=null)}function Zn(){var o=i.props.appendTo,p,g=W();i.props.interactive&&o===zn||o==="parent"?p=g.parentNode:p=Hn(o,[g]),p.contains(c)||p.appendChild(c),i.state.isMounted=!0,mn()}function Xe(){return Ze(c.querySelectorAll("[data-tippy-root]"))}function gn(o){i.clearDelayTimeouts(),o&&L("onTrigger",[i,o]),z();var p=re(!0),g=xe(),j=g[0],v=g[1];ie.isTouch&&j==="hold"&&v&&(p=v),p?l=setTimeout(function(){i.show()},p):i.show()}function Ue(o){if(i.clearDelayTimeouts(),L("onUntrigger",[i,o]),!i.state.isVisible){le();return}if(!(i.props.trigger.indexOf("mouseenter")>=0&&i.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(o.type)>=0&&h)){var p=re(!1);p?t=setTimeout(function(){i.state.isVisible&&i.hide()},p):x=requestAnimationFrame(function(){i.hide()})}}function Kn(){i.state.isEnabled=!0}function Qn(){i.hide(),i.state.isEnabled=!1}function Xn(){clearTimeout(l),clearTimeout(t),cancelAnimationFrame(x)}function Jn(o){if(!i.state.isDestroyed){L("onBeforeUpdate",[i,o]),me();var p=i.props,g=In(n,Object.assign({},p,Ln(o),{ignoreAttributes:!0}));i.props=g,fe(),p.interactiveDebounce!==g.interactiveDebounce&&(r(),k=On(Ie,g.interactiveDebounce)),p.triggerTarget&&!g.triggerTarget?Me(p.triggerTarget).forEach(function(j){j.removeAttribute("aria-expanded")}):g.triggerTarget&&n.removeAttribute("aria-expanded"),f(),oe(),ge&&ge(p,g),i.popperInstance&&(mn(),Xe().forEach(function(j){requestAnimationFrame(j._tippy.popperInstance.forceUpdate)})),L("onAfterUpdate",[i,o])}}function Yn(o){i.setProps({content:o})}function et(){var o=i.state.isVisible,p=i.state.isDestroyed,g=!i.state.isEnabled,j=ie.isTouch&&!i.props.touch,v=sn(i.props.duration,0,ee.duration);if(!(o||p||g||j)&&!W().hasAttribute("disabled")&&(L("onShow",[i],!1),i.props.onShow(i)!==!1)){if(i.state.isVisible=!0,F()&&(c.style.visibility="visible"),oe(),z(),i.state.isMounted||(c.style.transition="none"),F()){var N=te(),$=N.box,Oe=N.content;rn([$,Oe],0)}G=function(){var ye;if(!(!i.state.isVisible||w)){if(w=!0,c.offsetHeight,c.style.transition=i.props.moveTransition,F()&&i.props.animation){var Je=te(),_e=Je.box,ke=Je.content;rn([_e,ke],v),Dn([_e,ke],"visible")}ae(),f(),kn($e,i),(ye=i.popperInstance)==null||ye.forceUpdate(),L("onMount",[i]),i.props.animation&&F()&&s(v,function(){i.state.isShown=!0,L("onShown",[i])})}},Zn()}}function nt(){var o=!i.state.isVisible,p=i.state.isDestroyed,g=!i.state.isEnabled,j=sn(i.props.duration,1,ee.duration);if(!(o||p||g)&&(L("onHide",[i],!1),i.props.onHide(i)!==!1)){if(i.state.isVisible=!1,i.state.isShown=!1,w=!1,h=!1,F()&&(c.style.visibility="hidden"),r(),le(),oe(!0),F()){var v=te(),N=v.box,$=v.content;i.props.animation&&(rn([N,$],j),Dn([N,$],"hidden"))}ae(),f(),i.props.animation?F()&&ve(j,i.unmount):i.unmount()}}function tt(o){ne().addEventListener("mousemove",k),kn(We,k),k(o)}function it(){i.state.isVisible&&i.hide(),i.state.isMounted&&(hn(),Xe().forEach(function(o){o._tippy.unmount()}),c.parentNode&&c.parentNode.removeChild(c),$e=$e.filter(function(o){return o!==i}),i.state.isMounted=!1,L("onHidden",[i]))}function st(){i.state.isDestroyed||(i.clearDelayTimeouts(),i.unmount(),me(),delete n._tippy,i.state.isDestroyed=!0,L("onDestroy",[i]))}}function Qe(n,a){a===void 0&&(a={});var u=ee.plugins.concat(a.plugins||[]);Si();var l=Object.assign({},a,{plugins:u}),t=Ei(n),x=t.reduce(function(h,C){var m=C&&Vi(C,l);return m&&h.push(m),h},[]);return Ke(n)?x[0]:x}Qe.defaultProps=ee;Qe.setDefaultProps=Ri;Qe.currentInput=ie;var Bi=function(a){var u=a===void 0?{}:a,l=u.exclude,t=u.duration;$e.forEach(function(x){var h=!1;if(l&&(h=Gn(l)?x.reference===l:x.popper===l.popper),!h){var C=x.props.duration;x.setProps({duration:t}),x.hide(),x.state.isDestroyed||x.setProps({duration:C})}})};Object.assign({},Bt,{effect:function(a){var u=a.state,l={popper:{position:u.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(u.elements.popper.style,l.popper),u.styles=l,u.elements.arrow&&Object.assign(u.elements.arrow.style,l.arrow)}});Qe.setDefaultProps({render:$n});const gs=({appId:n})=>{var Y,se;y.debug(n);const a=pn(),u=un(dn.getState(),n),l=u.src.dbs,t=u.src.tbl;y.debug("metaData",u,l,t);const[x,h]=R.useState(!1),[C,m]=R.useState(!1),[w,T]=R.useState(!1),H=((Y=Pn)==null?void 0:Y.palette.mode)===Tt.LIGHT?(se=Pn)==null?void 0:se.palette.primary.main:"",G=i=>{a(Pt({anchor:i}))},I=()=>{a(St({})),setTimeout(function(){Bi()},20)},k=()=>{C?Ce("Please save or cancel compute field to save",{variant:"error"}):w?Ce("Column settings contains errors",{variant:"error"}):(zt(n,An.GLOBAL,l,t,i=>{if(i!=null&&i.code&&(i!=null&&i.message))switch(i.code){case"ok":Ce(i.message,{variant:"success"});break;case"error":Ce(i.message,{variant:"error"});break;default:Ce(i.message,{variant:"info"})}else y.error(i),Ce("Invalid response - check console for more information",{variant:"error"})}),Ht(n,An.GLOBAL,l,t,i=>{y.debug(i),i!=null&&i.code&&(i!=null&&i.message)||(y.error(i),Ce("Invalid response - check console for more information",{variant:"error"}))}))},M=()=>{x&&!C?(k(),setTimeout(()=>{I()},1e3)):I()},[q,U]=R.useState(Ee.TABLE);return e.jsxs(ti,{children:[e.jsx(Cn,{position:"static",sx:{borderRadius:0},children:e.jsxs(En,{className:"pp-setting-toolbar",sx:{borderRadius:0},children:[e.jsx(pi,{variant:"h5",noWrap:!0,component:"div",className:"unselectable",sx:{flexGrow:1,display:{xs:"none",sm:"block"},paddingLeft:"6px"},children:"Table Settings"}),e.jsx(ue,{title:"Dock to left",position:"bottom",children:e.jsx(de,{onClick:()=>{G(jn.LEFT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(ii,{})})}),e.jsx(ue,{title:"Dock to right",position:"bottom",children:e.jsx(de,{onClick:()=>{G(jn.RIGHT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(si,{})})}),e.jsx(ue,{title:"Close",position:"bottom",children:e.jsx(de,{onClick:I,size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(_t,{})})})]})}),e.jsx(Cn,{position:"static",className:"pp-setting-buttons-appbar",sx:{borderRadius:0},children:e.jsxs(En,{className:"pp-setting-buttons",children:[e.jsx(Ae,{variant:"text",onClick:()=>{U(Ee.TABLE)},children:"Table"}),e.jsx(Ae,{variant:"text",onClick:()=>{U(Ee.COLUMNS)},children:"Columns"}),e.jsx(Ae,{variant:"text",onClick:()=>{U(Ee.THEME)},children:"Theme"})]})}),e.jsxs(Sn,{className:"pp-settings-container",children:[q===Ee.TABLE&&e.jsx(mi,{appId:n,setIsUpdated:h}),q===Ee.COLUMNS&&e.jsx(hi,{appId:n,setIsUpdated:h,setComputeFieldOpen:m,setHasErrors:T}),q===Ee.THEME&&e.jsx(ni,{appId:n,setIsUpdated:h})]}),e.jsx(Sn,{className:"pp-setting-footer",sx:{borderRadius:0,backgroundColor:H},children:e.jsxs(fi,{className:"pp-setting-footer-buttons",sx:{borderRadius:0},children:[e.jsx(Ae,{variant:"outlined",className:"footer_action_button",onClick:k,children:"Apply"}),e.jsx(Ae,{variant:"outlined",className:"footer_action_button",onClick:M,children:"OK"}),e.jsx(Ae,{variant:"outlined",className:"footer_action_button",onClick:I,children:"Cancel"})]})})]})};export{gs as default};
