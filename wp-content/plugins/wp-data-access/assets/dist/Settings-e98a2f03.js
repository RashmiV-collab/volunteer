import{l as o,r as h,j as e,aj as j,an as q,C as W,ai as K,L as J,$ as N,ao as G,ap as Q,aq as V}from"./main.js";import{A as C,a as T,b as S,S as X,R as Y,T as _,B as Z,c as ee}from"./settings-04aa9e8b.js";import{k,B as a,c as F,d as se,T as te,l as ie,R as ne,A as P,h as B,m as re,S as oe}from"./MetaData-bdfb949d.js";import{A as O}from"./AdminTheme-ba57f315.js";import{f as ae}from"./index.esm-df7700a0.js";import{T as w,a as le}from"./Actions-b625cbe1.js";import{C as ce}from"./ConfirmDialog-c5a9ed7e.js";import{B as m}from"./Button-e7d59fde.js";import{F as f}from"./FormHelperText-d043b602.js";import{T as A,I as b}from"./iconBase-8840166b.js";import{R as M}from"./RadioGroup-04724101.js";import{F as x}from"./Select-2486f905.js";import{R as g}from"./Radio-4f834152.js";import{T as de}from"./TextField-0f586f77.js";import{C as z,a as pe}from"./CardContent-eb18906e.js";import"./Switch-9746da4d.js";import"./Close-9e29875c.js";import"./createSvgIcon-d0cfe483.js";import"./Chip-505aa5a1.js";import"./FormControlLabel-b874e6c1.js";import"./DialogContent-0fdbfaca.js";import"./DialogTitle-3605c73e.js";import"./FormControl-5d7bce62.js";const me=({dbs:t,tbl:i})=>{o.debug(t,i);const[n,s]=h.useState(!1),[u,p]=h.useState(void 0);return e.jsxs(e.Fragment,{children:[e.jsxs(C,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(k,{}),children:"Reset User Interface Settings"}),e.jsx(S,{children:e.jsxs(a,{sx:{display:"grid",gridGap:"20px"},children:[e.jsxs(a,{sx:{display:"inline-grid",gridGap:"5px"},children:[e.jsx(m,{variant:"outlined",color:"primary",onClick:()=>{p(w.TABLE),s(!0)},children:"Delete table settings"}),e.jsx(f,{children:"This action cannot be undone!"})]}),e.jsxs(a,{sx:{display:"inline-grid",gridGap:"5px"},children:[e.jsx(m,{variant:"outlined",color:"primary",onClick:()=>{p(w.FORM),s(!0)},children:"Delete form settings"}),e.jsx(f,{children:"This action cannot be undone!"})]}),e.jsxs(a,{sx:{display:"inline-grid",gridGap:"5px"},children:[e.jsx(m,{variant:"outlined",color:"primary",onClick:()=>{p(w.THEME),s(!0)},children:"Delete theme settings"}),e.jsx(f,{children:"This action cannot be undone!"})]})]})})]}),e.jsx(ce,{title:`Delete ${u} settings?`,message:"Are you sure? This action cannot be undone!",open:n,setOpen:s,onConfirm:()=>{u!==void 0&&le(X.GLOBAL,u,t,i,null,r=>{if(r!=null&&r.code&&(r!=null&&r.message))switch(r.code){case"ok":j(r.message,{variant:"success"});break;case"error":j(r.message,{variant:"error"});break;default:j(r.message,{variant:"info"})}else o.error(r),j("Invalid response - check console for more information",{variant:"error"})})}})]})},ue=({dbs:t,tbl:i})=>{o.debug(t,i),F();const n=se(s=>q(s));return o.debug(n),e.jsxs(C,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(k,{}),children:"Table Settings"}),e.jsx(S,{children:e.jsxs(a,{sx:{display:"grid",gridGap:"10px"},children:[e.jsxs(a,{children:[e.jsx(A,{variant:"subtitle1",children:"Row Count Calculations"}),e.jsx(f,{children:"Affects InnoDB tables, federated tables and views only"})]}),e.jsx(a,{children:e.jsxs(M,{sx:{display:"grid",gridTemplateColumns:"1fr",justifyContent:"center",alignItems:"center"},children:[e.jsxs(x,{className:"align-label-radio",children:[e.jsx(g,{checked:n.table_settings.row_count_estimate===!0,disabled:!0,onChange:s=>{s.stopPropagation()}}),"Show row count estimate (faster but less accurate)"]}),e.jsxs(M,{sx:{marginLeft:"30px"},children:[e.jsxs(x,{className:"align-label-radio",children:[e.jsx(g,{checked:n.table_settings.row_count_estimate_value==="plugin",disabled:!0,onChange:s=>{s.stopPropagation()}}),"Use plugin estimate"]}),e.jsxs(a,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto auto",justifyContent:"left",alignItems:"center"},children:[e.jsxs(x,{children:[e.jsx(g,{checked:n.table_settings.row_count_estimate_value==="hard",disabled:!0,onChange:s=>{s.stopPropagation()}}),"Use hard estimate:"]}),e.jsx(de,{type:"number",value:n.table_settings.row_count_estimate_value_hard??"",disabled:!0,id:"pp-cells-before",sx:{width:"90px",marginLeft:"10px"},className:"pp-cells-before",InputLabelProps:{shrink:!0},onChange:s=>{s.stopPropagation()}}),e.jsx(te,{title:"Get real row count",children:e.jsx(b,{children:e.jsx(ie,{})})})]})]}),e.jsxs(x,{className:"align-label-radio",children:[e.jsx(g,{checked:n.table_settings.row_count_estimate===!1,disabled:!0,onChange:s=>{s.stopPropagation()}}),"Show real row count (slower but more accurate)"]}),e.jsx(a,{children:e.jsxs(x,{className:"align-label-radio",children:[e.jsx(g,{checked:n.table_settings.row_count_estimate===null,disabled:!0,onChange:s=>{s.stopPropagation()}}),"Let plugin decide (calculation depends on table size)"]})})]})})]})})]})},xe=({dbs:t,tbl:i})=>(o.debug(t,i),e.jsxs(C,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(k,{}),children:"Column Settings"}),e.jsx(S,{children:"TO DO"})]})),ge=({dbs:t,tbl:i})=>(o.debug(t,i),e.jsxs(C,{TransitionProps:{unmountOnExit:!0},disableGutters:!0,children:[e.jsx(T,{expandIcon:e.jsx(k,{}),children:"REST API"}),e.jsx(S,{children:"TO DO"})]})),Me=({dbs:t,tbl:i})=>{var R,E;o.debug(t,i);const n=F(),[s,u]=h.useState(""),[p,r]=h.useState(!1);h.useEffect(()=>{p||U()},[t,i]);const U=()=>{ne(W.appUrlMeta,{dbs:t,tbl:i},function(l){var L,I;const d=l==null?void 0:l.data;if(o.debug("response data",t,i,d),(L=d==null?void 0:d.access)!=null&&L.select&&Array.isArray(d.access.select)&&d.access.select.includes("POST")){const c={...d.settings};delete c.hyperlinks,delete c.ui,n(Q({settings:c})),r(!0)}else{let c="Unauthorized";(I=l==null?void 0:l.data)!=null&&I.message&&(c=l.data.message),c+=" - check console for more information",o.error(c),u(c)}})},H=((R=O)==null?void 0:R.palette.mode)===K.LIGHT?(E=O)==null?void 0:E.palette.primary.main:"",v=l=>{n(V({anchor:l}))},y=()=>{n(N({}))},D=()=>{o.error("apply...")},$=()=>{o.error("ok..."),D(),setTimeout(()=>{y()},1e3)};return s!==""?(n(J({error:s})),n(N({})),null):p?e.jsxs(Y,{children:[e.jsx(P,{position:"static",sx:{borderRadius:0},children:e.jsxs(B,{className:"pp-setting-toolbar",sx:{borderRadius:0},children:[e.jsx(A,{variant:"h5",noWrap:!0,component:"div",className:"unselectable",sx:{flexGrow:1,display:{xs:"none",sm:"block"},paddingLeft:"6px"},children:"Settings"}),e.jsx(_,{title:"Dock to left",position:"bottom",children:e.jsx(b,{onClick:()=>{v(G.LEFT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Z,{})})}),e.jsx(_,{title:"Dock to right",position:"bottom",children:e.jsx(b,{onClick:()=>{v(G.RIGHT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(ee,{})})}),e.jsx(_,{title:"Close",position:"bottom",children:e.jsx(b,{onClick:y,size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(re,{})})})]})}),e.jsx(P,{position:"static",className:"pp-setting-buttons-appbar",sx:{borderRadius:0,padding:"0 0 15px 25px !important"},children:e.jsx(B,{className:"pp-setting-buttons",children:e.jsxs(a,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",justifyContent:"left",alignItems:"center",gap:"5px"},children:[e.jsx(ae,{}),e.jsxs(A,{variant:"subtitle1",noWrap:!0,component:"div",className:"unselectable",children:[t," - ",i]})]})})}),e.jsxs(z,{className:"pp-settings-container",children:[e.jsx(ue,{dbs:t,tbl:i}),e.jsx(xe,{dbs:t,tbl:i}),!1,!1,e.jsx(ge,{dbs:t,tbl:i}),e.jsx(me,{dbs:t,tbl:i})]}),e.jsx(z,{className:"pp-setting-footer",sx:{borderRadius:0,backgroundColor:H},children:e.jsxs(pe,{className:"pp-setting-footer-buttons",sx:{borderRadius:0},children:[e.jsx(m,{variant:"outlined",className:"footer_action_button",onClick:D,children:"Apply"}),e.jsx(m,{variant:"outlined",className:"footer_action_button",onClick:$,children:"OK"}),e.jsx(m,{variant:"outlined",className:"footer_action_button",onClick:y,children:"Cancel"})]})})]}):e.jsx(oe,{title:"Loading meta data..."})};export{Me as default};
