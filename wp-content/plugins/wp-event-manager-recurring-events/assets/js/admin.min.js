var AdminRecurring=function(){return{init:function(){jQuery("#_event_recurrence").length>0&&(AdminRecurring.actions.onChangeRecurrence(),jQuery("#_event_recurrence").on("change",AdminRecurring.actions.onChangeRecurrence)),jQuery(".recurring-now-btn").on("click",AdminRecurring.actions.recurreEventNow),jQuery(".recurring-delete-btn").on("click",AdminRecurring.actions.recurreDeleteEvent),jQuery(".tips, .help_tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},actions:{onChangeRecurrence:function(){var e=jQuery("#_event_recurrence").val();jQuery("input[name=_recure_time_period]").length>0&&"monthly"==e&&(AdminRecurring.actions.onchangeTimePeriod(),jQuery("input[name=_recure_time_period]").on("change",AdminRecurring.actions.onchangeTimePeriod)),""!=e&&"no"!=e||(AdminRecurring.actions.updateRecureEvery(!0),AdminRecurring.actions.updateEventUntill(!0),AdminRecurring.actions.updateRecureWeekday(!0),AdminRecurring.actions.updateRecureTimePeriod(!0),AdminRecurring.actions.updateRecureMonthDay(!0),jQuery("#_recure_month_day").parent("p.form-field").hide(),jQuery("#_recure_weekday").parent("p.form-field").hide()),"daily"==e&&(AdminRecurring.actions.updateRecureEvery(!1),AdminRecurring.actions.updateEventUntill(!1),AdminRecurring.actions.updateRecureWeekday(!0),AdminRecurring.actions.updateRecureTimePeriod(!0),AdminRecurring.actions.updateRecureMonthDay(!0),jQuery("#_recure_month_day").parent("p.form-field").hide(),jQuery("#_recure_weekday").parent("p.form-field").hide(),jQuery("input[name=_recure_every]").length>0&&jQuery("input[name=_recure_every]").prev("lable span").html(event_manager_recurring_events.every_day)),"weekly"==e&&(AdminRecurring.actions.updateRecureEvery(!1),AdminRecurring.actions.updateEventUntill(!1),AdminRecurring.actions.updateRecureWeekday(!1),AdminRecurring.actions.updateRecureTimePeriod(!0),AdminRecurring.actions.updateRecureMonthDay(!0),jQuery("#_recure_month_day").parent("p.form-field").hide(),jQuery("#_recure_weekday").parent("p.form-field").show(),jQuery("input[name=_recure_every]").length>0&&jQuery("input[name=_recure_every]").prev("lable span").html(event_manager_recurring_events.every_week)),"monthly"==e&&(AdminRecurring.actions.updateRecureEvery(!1),AdminRecurring.actions.updateEventUntill(!1),AdminRecurring.actions.updateRecureWeekday(!1),AdminRecurring.actions.updateRecureTimePeriod(!1),AdminRecurring.actions.updateRecureMonthDay(!0),AdminRecurring.actions.onchangeTimePeriod(),jQuery("input[name=_recure_every]").length>0&&jQuery("input[name=_recure_every]").prev("lable span").html(event_manager_recurring_events.every_month)),"yearly"==e&&(AdminRecurring.actions.updateRecureEvery(!1),AdminRecurring.actions.updateEventUntill(!1),AdminRecurring.actions.updateRecureWeekday(!0),AdminRecurring.actions.updateRecureTimePeriod(!0),AdminRecurring.actions.updateRecureMonthDay(!0),jQuery("#_recure_month_day").parent("p.form-field").hide(),jQuery("#_recure_weekday").parent("p.form-field").hide(),jQuery("input[name=_recure_every]").length>0&&jQuery("input[name=_recure_every]").prev("lable span").html(event_manager_recurring_events.every_year))},recurreEventNow:function(e){var r=this.id,n=jQuery("#"+r).attr("data-eventid"),t=jQuery("#"+r).attr("data-start-date"),i=jQuery("#"+r).attr("data-end-date"),u=jQuery("#"+r).attr("data-registration-expiry-date"),a={action:"create_event_recurring",event_id:n,start_date:t,end_date:i,registration_expiry_date:u};jQuery.ajax({type:"POST",url:event_manager_recurring_events.ajax_url,data:a,beforeSend:function(e,t){jQuery("#"+r).attr("disabled","disabled"),jQuery("#"+n+"_view").attr("disabled","disabled"),jQuery("#"+n+"_recurre_delete").attr("disabled","disabled"),jQuery("#"+r).click(!1),jQuery("#"+n+"_view").click(!1),jQuery("#"+r).closest(".column-action").find(".spinner").addClass("is-active")},success:function(e){if(1==e.status)jQuery("#"+r).attr("data-start-date",e.start_date),jQuery("#"+r).attr("data-end-date",e.end_date),jQuery("#"+r).attr("data-registration-expiry-date",e.registration_expiry_date),jQuery("#"+r).trigger("click");else{jQuery("#"+r).closest(".column-action").find(".spinner").removeClass("is-active");var n=window.location.href;n.indexOf("?")>-1?n+="&create_rec=1":n+="?create_rec=1",window.location.href=n}},error:function(e,r,n){console.log("error")},complete:function(e,r){console.log("complete")}})},recurreDeleteEvent:function(e=!0){var r=this.id,n=jQuery("#"+r).attr("data-eventid"),t={action:"delete_event_recurring",event_id:n};jQuery.ajax({type:"POST",url:event_manager_recurring_events.ajax_url,data:t,beforeSend:function(e,t){jQuery("#"+r).attr("disabled","disabled"),jQuery("#"+n+"_recurre").attr("disabled","disabled"),jQuery("#"+n+"_view").attr("disabled","disabled"),jQuery("#"+r).click(!1),jQuery("#"+n+"_view").click(!1),jQuery("#"+r).closest(".column-action").find(".spinner").addClass("is-active")},success:function(e){if(1==e.status){jQuery("#"+r).closest(".column-action").find(".spinner").removeClass("is-active");var n=window.location.href;n.indexOf("?")>-1?n+="&del_rec=1":n+="?del_rec=1",window.location.href=n}},error:function(e,r,n){console.log("error")},complete:function(e,r){console.log("complete")}})},updateRecureEvery:function(e=!0){1==e?jQuery("input[name=_recure_every]").length>0&&(jQuery("input[name=_recure_every]").removeAttr("required","required"),jQuery("input[name=_recure_every]").parent("p").hide()):jQuery("input[name=_recure_every]").length>0&&(jQuery("input[name=_recure_every]").attr("required","required"),jQuery("input[name=_recure_every]").parent("p").show())},updateEventUntill:function(e=!0){1==e?jQuery("input[name=_recure_untill]").length>0&&(jQuery("input[name=_recure_untill]").removeAttr("required","required"),jQuery("input[name=_recure_untill]").parent("p").hide()):jQuery("input[name=_recure_untill]").length>0&&(jQuery("input[name=_recure_untill]").attr("required","required"),jQuery("input[name=_recure_untill]").parent("p").show())},updateRecureWeekday:function(e=!0){1==e?jQuery("select[name=_recure_weekday]").length>0&&(jQuery("select[name=_recure_weekday]").removeAttr("required","required"),jQuery("select[name=_recure_weekday]").parent("p").hide()):jQuery("select[name=_recure_weekday]").length>0&&(jQuery("select[name=_recure_weekday]").attr("required","required"),jQuery("select[name=_recure_weekday]").parent("p").show())},updateRecureTimePeriod:function(e=!0){1==e?jQuery("input[name=_recure_time_period]").length>0&&(jQuery("input[name=_recure_time_period]").removeAttr("required","required"),jQuery("input[name=_recure_time_period]").closest("p").hide()):jQuery("input[name=_recure_time_period]").length>0&&(jQuery("input[name=_recure_time_period]").attr("required","required"),jQuery("input[name=_recure_time_period]").closest("p").show())},updateRecureMonthDay:function(e=!0){1==e?jQuery("select[name=_recure_month_day]").length>0&&(jQuery("select[name=_recure_month_day]").removeAttr("required","required"),jQuery("select[name=_recure_month_day]").parent("p.form-field").hide()):jQuery("select[name=_recure_month_day]").length>0&&(jQuery("select[name=_recure_month_day]").attr("required","required"),jQuery("select[name=_recure_month_day]").parent("p.form-field").show())},onchangeTimePeriod:function(e=!0){"specific_time"==jQuery("input[name=_recure_time_period]:checked").val()?(AdminRecurring.actions.updateRecureMonthDay(!1),AdminRecurring.actions.updateRecureWeekday(!1),jQuery("#_recure_month_day").parent("p.form-field").show(),jQuery("#_recure_weekday").parent("p.form-field").show()):(AdminRecurring.actions.updateRecureMonthDay(!0),AdminRecurring.actions.updateRecureWeekday(!0),jQuery("#_recure_month_day").parent("p.form-field").hide(),jQuery("#_recure_weekday").parent("p.form-field").hide())}}}};AdminRecurring=AdminRecurring(),jQuery(document).ready((function(e){AdminRecurring.init()}));